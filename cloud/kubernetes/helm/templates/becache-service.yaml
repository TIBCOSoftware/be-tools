#
# Copyright (c) 2019-2020. TIBCO Software Inc.
# This file is subject to the license terms contained in the license file that is distributed with this file.
#
{{- if or (eq .Values.cmType "as2" ) (eq .Values.cmType "ftl" ) (eq .Values.cmType "unclustered" ) (eq .Values.cmType "ignite" ) }}
{{- if eq .Values.omType "cache" }}
  {{- if or (eq .Values.bsType "none" ) (eq .Values.bsType "sharednothing" ) (eq .Values.bsType "store" ) }}
apiVersion: v1
kind: Service
metadata:
  name: {{ include "cacheservice.fullname" . }}
spec:
  selector:
    name: {{ include "becacheagent.fullname" . }}
  clusterIP: None
  ports:
  {{- if eq .Values.cmType "as2" }}
    - port: {{ .Values.cacheservice.ports.port }}
      protocol: TCP
  {{- end }}
  {{- if or (eq .Values.cmType "ftl" )  (eq .Values.cmType "ignite" ) }}
  {{- range $key, $port := $.Values.ignitePort }}
    - port: {{ $port }}
      name: {{ $key }}
      protocol: TCP
  {{- end }}
  {{- end }}
  {{- end }}
{{- end }}
{{- end }}
