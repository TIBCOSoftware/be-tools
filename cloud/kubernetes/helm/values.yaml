
#
# Copyright (c) 2019-2020. TIBCO Software Inc.
# This file is subject to the license terms contained in the license file that is distributed with this file.
#

# Default values.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

#Required parameter to be passed for all cloud providers
cpType: minikube      #cpType can be minikube, aws, awsfargate, awsefs, azure, openshift OR gcp
#-----------------------------------------
cmType: unclustered                     #cmType can be unclustered,as2,ftl,ignite
omType: inmemory                        #omType can be inmemory,store,cache
bsType: na                              #BackingStore can be none sharednothing, store
storeType: na                           #storeType can be rdbms, as4, cassandra
cacheType: as2                          #cacheType can be as2, ignite

# Image name and pull policy required for be app
image: befdapp:01
imagePullPolicy: IfNotPresent
# imagepullsecret Provide image pull secret name, If the image is available in a private registry. You can create image pull secret manually OR use imageCredentials section to create it. 
imagepullsecret:

# imageCredentials Credentials to pull image from a private registry. You can skip this if you want create image pull secret manually.
imageCredentials:
  registry:                             #Ex: hub.docker.com
  username:
  password:
  email:

#*************************Agents env varaibles****************************************************

# ignite.discovery_url is GV of discovery URL
ignite:
  discovery_url: IGNITE_gv_DISCOVERY_URL
  serviceaccount: ignitecache

# ignite_gv requires to define in key as GV and value as value, define all gv's except ignite URL and update the ignite listen ports as per requirement
ignite_gv:
  IGNITE_gv_LISTEN_PORT: "47500..47510"
  IGNITE_gv_COMMUNICATION_PORT: "47100..47110"
  tra.be.ignite.discovery.type: k8s     # Do not edit this property, It is used for Ignite Service Discovery
  tra.be.ignite.k8s.namespace: default  # Do not edit this property, It is used for Ignite Service Discovery
  
ftl:
  FTL_gv_REALM_SERVER: http://localhost:8585
  FTL_gv_CLUSTER_NAME: ftl.default.cluster

env:
  # Consul GV provider specific environment variables
  # CONSUL_SERVER_URL: http://192.168.0.1:8500
  # BE_APP_NAME: fd
  # APP_CONFIG_PROFILE: test
  # HTTP GV provider specific environment variables
  # GVP_HTTP_SERVER_URL: URL
  # GVP_HTTP_HEADERS: "Content-Type:application/json"
  # custom gv provider specific environment variables
  # other environment variables
  
#*************************Agents Part****************************************************

#Required for cache, sharednothing, store in  all cloud providers
cachenode:
  name: becacheagent
  replicaCount: 1       # Number of cache nodes
  discoveryCount: 1     # Number discovery nodes (applicable only for cmType = as2). It should not be more than number of cache nodes i.e. cachenode.replicaCount
  containers:
    name: cachenode

#Required for all applications in  all cloud providers
inferencenode:
  name: beinferenceagent
  replicaCount: 1       # Number of inference nodes    
  containers:
    name: inferencenode

#*************************Health check Part****************************************************
# Required for cache and inference agent health check
healthcheck:
  enabled: false        #Set to true - to enable healthcheck
  livenessProbe:
    port: 5555
    initialDelaySeconds: 5
    periodSeconds: 5
  readinessProbe:
    port: 5555
    initialDelaySeconds: 5 
    periodSeconds: 5 

# Resource memory for EKS Fargate pods
resources:
  memory: 1.2Gi
  cpu: 1
aws:
  efsFileSystemId: fs-12345678   #update for awsfargate(cpType=awsfargate) - for EKS and KOPS cluster with storage class type efs set cpType=awsefs

#*************************Service Part****************************************************
#Required for cache, sharednothing, store in all cloud providers
cacheservice:
  name: becache-service
  ports:
    port: 50000
    protocol: TCP

#Required for all applications in all cloud providers
jmxservice:
  name: jmx-service
  ports:
    protocol: TCP
    port: 5555
    targetPort: 5555
  type: LoadBalancer

#Required for all applications in all cloud providers
beservice:
  name: beservice
  type: NodePort              #supported values: NodePort, LoadBalancer or clusterIP
  ports:
    name: port1
    protocol: TCP
    port: 8108

ignitePort:
  dis0: 47500
  dis1: 47501
  dis2: 47502
  dis3: 47503
  dis4: 47504
  dis5: 47505
  dis6: 47506
  dis7: 47507
  dis8: 47508
  dis9: 47509
  dis10: 47510  

#*************************ConfigMap****************************************************

#Required for store in all cloud providers
configmapname: storeconfig

configmap:
  dbdriver: com.mysql.jdbc.Driver
  dburl: jdbc:mysql://mysql-0.mysql.default.svc.cluster.local:3306/BE_DATABASE
  dbusername: BE_USER
  dbpwd: BE_USER
  dbpoolsize: 5
  dblogintimeout: 0

#Required for store in all cloud providers
database:
  BACKINGSTORE_JDBC_DRIVER: dbdriver 
  BACKINGSTORE_JDBC_URL: dburl
  BACKINGSTORE_JDBC_USERNAME: dbusername
  BACKINGSTORE_JDBC_PASSWORD: dbpwd
  BACKINGSTORE_JDBC_POOL_SIZE: dbpoolsize 
  BACKINGSTORE_JDBC_LOGIN_TIMEOUT: dblogintimeout 

cassconfigmap:
  cass_server: localhost:9042
  cass_keyspace_name: testdb
  cass_username: cassandra
  cass_password: cassandra

cassdatabase:
  CASS_SERVER: cass_server
  CASS_KEYSPACE_NAME: cass_keyspace_name
  CASS_USERNAME: cass_username
  CASS_PASSWORD: cass_password

as4configmap:
  realm_url: http://localhost:8585
  sec_realm_url: http://localhost:8585
  grid_name: fd_store
  store_timeout: 5
  store_waittime: 0.1
  store_poolsize: 1

as4database:
  REALM_URL: realm_url
  SEC_REALM_URL: sec_realm_url
  GRID_NAME: grid_name
  STORE_TIMEOUT: store_timeout
  STORE_WAITTIME: "store_waittime"
  STORE_POOLSIZE: store_poolsize  

#*************************Volumes Part****************************************************
volumes:
  #Required for sharednothing and store in all cloud providers
  snmountPath: "/mnt/tibco/be/data-store"
  snmountVolume: store
  accessModes: ["ReadWriteOnce"]
  storage: 0.5Gi
  storageClass: standard                    #Use one of the available storage classes as per your preference
  snclaimVolume: pv0003

#Required for store in  all cloud providers
mysql:
  enabled: false              #use true for store
  image:
    repository: "mysql"
    tag: "5.7"
  primary:
    args: [ "--lower_case_table_names=1","--sql_mode=IGNORE_SPACE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION" ]
    persistence:
      enabled: false
      # storageClass: "-"     #Type of persistent volume claim
  auth:
    username: root1
    password: password12
    rootPassword: password12
    database: BE_DATABASE  #database name

# Required for sharednothing and store in AWS(Only for cpType=aws)
aws-efs:
  enabled: false              #use true to create aws-efs provisioner.If you enable this, update volumes.storageClass to "aws-efs" 
  replicaCount: 1
  efsProvisioner:
    efsFileSystemId: fs-e8f5fa68
    awsRegion: us-east-1

# ---------------------------------Information related to metrics(influx/liveview)-------------------------------------------------

metricsType: na           # metricsType value is strict to "influx","liveview","custom"

influxconfigmap:
  dburl: http://influxDB:8086
  bucket: fdmetrics 
  dbtoken: be-examples-fdmetrics-token
  dborg: be-examples  

influxdatabase:
  INFLUXDB_URL: dburl
  INFLUXBUCKET: bucket
  INFLUXTOKEN: dbtoken
  INFLUXORG: dborg

# Custom values for InfluxDB chart, setting influxdb.enabled to true will deploy influxDB helm chart
influxdb:
  enabled: false
  image:  # Comment influx image, repository and tag for BE version 6.0 
    repository: quay.io/influxdb/influxdb   
    tag: v2.0.1
  persistence:
    enabled: false            # Set to true for persistence


# Custom values for Grafana chart, setting influxdb.enabled to true will deploy grafana helm chart
grafana:
  enabled: false
  image:
    tag: 7.3.5
  service:
    type: NodePort          # Default is clusterIP, Loadbalancer for Azure(Change as per requirement)

# --------- Streambase and liveview information ------

sbconfigmap:
  ldmurl: lv://localhost:10080

streambase:
  LDM_URL: ldmurl

# custom metrics(ex:elastic, prometheus etc.,)

metricdetails:
  URL: http://localhost:1234
